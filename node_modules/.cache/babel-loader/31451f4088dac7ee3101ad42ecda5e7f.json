{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Digivox\\\\dev\\\\Digivox\\\\Refatoracao\\\\squad\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\Users\\\\Digivox\\\\dev\\\\Digivox\\\\Refatoracao\\\\squad\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{Button}from\"reactstrap\";import SimpleBar from\"simplebar-react\";import{useChat}from\"../contexts/ChatContext\";import AttachedFilesOnSidebar from\"./AttachedFilesOnSidebar\";import ReactImageFallback from\"react-image-fallback\";import defaultAvatar from\"../assets/images/default.png\";import{onImgError}from\"../helpers/ImageUtils\";import{useGroup}from\"../contexts/GroupContext\";import{useContact}from\"../contexts/ContactContext\";import{useAuth}from\"../contexts/AuthContext\";import{useModal}from\"./../contexts/ModalContext\";import ModalAddMember from\"./ModalAddMember\";import{Input}from\"@material-ui/core\";import UserStatusOnProfileSidebar from\"./UserStatusOnProfileSidebar\";import ChangeGroupNameButton from\"./ChangeGroupNameButton\";import LeaveGroupButton from\"./LeaveGroupButton\";import InfoHeadOnSidebar from\"./InfoHeadOnSidebar\";import MembersOnSidebar from\"./MembersOnSidebar\";import{useTranslation}from\"react-i18next\";import Swal from\"sweetalert2\";import{ModalEditConference}from\"./ModalEditConference\";import{useConference}from\"../contexts/ConferenceContext\";import ChatType from\"../enuns/ChatType\";var ChatProfileSidebar=function ChatProfileSidebar(_ref){var _activeChat$members,_activeChat$members2,_activeChat$members3;var show=_ref.show,setShow=_ref.setShow;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isOpen1=_useState2[0],setIsOpen1=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isOpen2=_useState4[0],setIsOpen2=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),newGroupName=_useState6[0],setGroupName=_useState6[1];var _useAuth=useAuth(),user=_useAuth.user;var _useChat=useChat(),activeChat=_useChat.activeChat,chats=_useChat.chats,setChats=_useChat.setChats,setActiveChat=_useChat.setActiveChat;var _useGroup=useGroup(),groups=_useGroup.groups,setGroups=_useGroup.setGroups;var _useContact=useContact(),contacts=_useContact.contacts,setContacts=_useContact.setContacts;var _useModal=useModal(),setShowModalAddMember=_useModal.setShowModalAddMember;var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showModal=_useState8[0],setShowModal=_useState8[1];var _useConference=useConference(),setConferenceToRemove=_useConference.setConferenceToRemove,conferenceList=_useConference.conferenceList;var toggleCollapse1=function toggleCollapse1(){setIsOpen1(!isOpen1);};var toggleCollapse2=function toggleCollapse2(){setIsOpen2(!isOpen2);};var closeUserSidebar=function closeUserSidebar(){setShow(false);};var getAttachedFiles=function getAttachedFiles(){if(show&&activeChat.attachedFileList===undefined){setActiveChat(_objectSpread(_objectSpread({},activeChat),{},{attachedFileList:[]}));}else if(!show){setActiveChat(_objectSpread(_objectSpread({},activeChat),{},{attachedFileList:undefined}));}};useEffect(function(){getAttachedFiles();// eslint-disable-next-line\nsetShowModal(false);// eslint-disable-next-line\n},[show]);var closeUserSidebarOnActiveChatChange=function closeUserSidebarOnActiveChatChange(){if(show&&activeChat.attachedFileList===undefined)closeUserSidebar();};useEffect(closeUserSidebarOnActiveChatChange,[activeChat]);var actualMember=(_activeChat$members=activeChat.members)===null||_activeChat$members===void 0?void 0:_activeChat$members.find(function(member){return member.userId===user.id;});var isAdmin=(actualMember===null||actualMember===void 0?void 0:actualMember.role)===\"admin\";//const groupAdmins = activeChat.members?.filter((member) => member.role === \"admin\");\nvar actualMembers=(_activeChat$members2=activeChat.members)===null||_activeChat$members2===void 0?void 0:_activeChat$members2.map(function(mb){return mb.userId;});var isGroup=activeChat.groupId;var membersArrayPreventingDuplicateDisplayMember=activeChat.chatType===ChatType.GROUP?(_activeChat$members3=activeChat.members)===null||_activeChat$members3===void 0?void 0:_activeChat$members3.filter(function(item,index,arrayCompleto){return arrayCompleto.findIndex(function(item2){return item.userId===item2.userId;})===index;}):activeChat.conferenceRoomParticipants;function swDelete(){Swal.fire({title:t(\"Do you want to delete the group '\".concat(activeChat.name,\"' ?\")),text:\"\",icon:\"warning\",showCancelButton:true,confirmButtonColor:\"#3085d6\",cancelButtonColor:\"#d33\",confirmButtonText:t(\"Yes\"),cancelButtonText:t(\"No\"),customClass:{popup:\"swal-mini-popup\"}}).then(function(result){if(result.isConfirmed){var conferenceData=conferenceList.find(function(conference){return conference.jid===activeChat.jid;});if(conferenceData)setConferenceToRemove(conferenceData);Swal.fire({position:\"center\",icon:\"success\",title:t(\"Deleted!\"),showConfirmButton:false,timer:1500,customClass:{popup:\"swal-mini-popup\"}});}});}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ModalEditConference,{show:showModal,toggle:function toggle(){return setShowModal(!showModal);}}),/*#__PURE__*/React.createElement(\"div\",{style:{display:show?\"block\":\"none\"},className:\"user-profile-sidebar \"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\",style:{justifyContent:\"center\"}},isGroup&&isAdmin&&/*#__PURE__*/React.createElement(\"div\",{className:\"px-3 px-lg-4 pt-3 pt-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-chat-nav text-right\"},/*#__PURE__*/React.createElement(Button,{color:\"none\",type:\"button\",className:\"nav-btn\",onClick:function onClick(){return setShowModalAddMember(true);}},/*#__PURE__*/React.createElement(\"i\",{className:\"ri-user-add-line\"})))),/*#__PURE__*/React.createElement(ModalAddMember,null),isGroup&&/*#__PURE__*/React.createElement(LeaveGroupButton,{activeChat:activeChat,actualMember:actualMember}),isGroup&&/*#__PURE__*/React.createElement(\"div\",{className:\"px-3 px-lg-4 pt-3 pt-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-chat-nav text-right\"},/*#__PURE__*/React.createElement(Button,{color:\"none\",type:\"button\",onClick:closeUserSidebar,className:\"nav-btn\",id:\"user-profile-hide\"},/*#__PURE__*/React.createElement(\"i\",{className:\"ri-close-line\"}))))),/*#__PURE__*/React.createElement(\"div\",{className:\"text-center px-4 pt-4 pb-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"mb-4 d-flex justify-content-center\"},!activeChat.profilePicture?/*#__PURE__*/React.createElement(\"div\",{className:\"avatar-lg\"},/*#__PURE__*/React.createElement(\"span\",{className:\"avatar-title rounded-circle bg-soft-primary text-primary font-size-24\"},activeChat.name.trim().charAt(0))):/*#__PURE__*/React.createElement(ReactImageFallback,{src:activeChat.profilePicture,onError:function onError(){if(activeChat.jid.includes(\"@conference.\"))onImgError(chats,groups,contacts,setChats,setGroups,setContacts,activeChat);},fallbackImage:defaultAvatar,className:\"rounded-circle avatar-lg img-thumbnail\",alt:\"chatvia\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-center\"},isGroup?/*#__PURE__*/React.createElement(Input,{inputProps:{min:0,style:{textAlign:\"center\"}},placeholder:activeChat.name,disableUnderline:true,fullWidth:true,onChange:function onChange(e){return setGroupName(e.target.value);}}):/*#__PURE__*/React.createElement(\"div\",null,activeChat.name)),isGroup&&newGroupName.length>0?/*#__PURE__*/React.createElement(ChangeGroupNameButton,{newGroupName:newGroupName,setGroupName:setGroupName,actualMembers:actualMembers}):isGroup&&/*#__PURE__*/React.createElement(\"i\",{className:\"ri-edit-line\"}),activeChat.status&&/*#__PURE__*/React.createElement(UserStatusOnProfileSidebar,null)),/*#__PURE__*/React.createElement(SimpleBar,{style:{maxHeight:\"100%\"},className:\"px-4 py-2 user-profile-desc\"},/*#__PURE__*/React.createElement(\"div\",{id:\"profile-user-accordion\",className:\"custom-accordion\"},/*#__PURE__*/React.createElement(InfoHeadOnSidebar,{activeChat:activeChat,toggleCollapse1:toggleCollapse1,isOpen1:isOpen1}),activeChat.jid.includes(\"@conference.\")&&/*#__PURE__*/React.createElement(MembersOnSidebar,{isAdmin:isAdmin,isOpen2:isOpen2,defaultAvatar:defaultAvatar,toggleCollapse2:toggleCollapse2,membersArrayPreventingDuplicateDisplayMember:membersArrayPreventingDuplicateDisplayMember}),/*#__PURE__*/React.createElement(AttachedFilesOnSidebar,null),activeChat.chatType===ChatType.CONFERENCE&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-center my-3\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary btn-block\",onClick:function onClick(){return setShowModal(true);}},/*#__PURE__*/React.createElement(\"div\",null,t(\"Edit group\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-center\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-danger btn-block\",onClick:swDelete},/*#__PURE__*/React.createElement(\"div\",null,t(\"Delete group\")))))))));};export default ChatProfileSidebar;","map":{"version":3,"sources":["C:/Users/Digivox/dev/Digivox/Refatoracao/squad/src/components/ChatProfileSidebar.tsx"],"names":["React","useEffect","useState","Button","SimpleBar","useChat","AttachedFilesOnSidebar","ReactImageFallback","defaultAvatar","onImgError","useGroup","useContact","useAuth","useModal","ModalAddMember","Input","UserStatusOnProfileSidebar","ChangeGroupNameButton","LeaveGroupButton","InfoHeadOnSidebar","MembersOnSidebar","useTranslation","Swal","ModalEditConference","useConference","ChatType","ChatProfileSidebar","show","setShow","t","isOpen1","setIsOpen1","isOpen2","setIsOpen2","newGroupName","setGroupName","user","activeChat","chats","setChats","setActiveChat","groups","setGroups","contacts","setContacts","setShowModalAddMember","showModal","setShowModal","setConferenceToRemove","conferenceList","toggleCollapse1","toggleCollapse2","closeUserSidebar","getAttachedFiles","attachedFileList","undefined","closeUserSidebarOnActiveChatChange","actualMember","members","find","member","userId","id","isAdmin","role","actualMembers","map","mb","isGroup","groupId","membersArrayPreventingDuplicateDisplayMember","chatType","GROUP","filter","item","index","arrayCompleto","findIndex","item2","conferenceRoomParticipants","swDelete","fire","title","name","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","customClass","popup","then","result","isConfirmed","conferenceData","conference","jid","position","showConfirmButton","timer","display","justifyContent","profilePicture","trim","charAt","includes","min","style","textAlign","e","target","value","length","status","maxHeight","CONFERENCE"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Button } from \"reactstrap\";\r\nimport SimpleBar from \"simplebar-react\";\r\nimport { useChat } from \"../contexts/ChatContext\";\r\nimport AttachedFilesOnSidebar from \"./AttachedFilesOnSidebar\";\r\nimport ReactImageFallback from \"react-image-fallback\";\r\nimport defaultAvatar from \"../assets/images/default.png\";\r\nimport { onImgError } from \"../helpers/ImageUtils\";\r\nimport { useGroup } from \"../contexts/GroupContext\";\r\nimport { useContact } from \"../contexts/ContactContext\";\r\nimport { useAuth } from \"../contexts/AuthContext\";\r\nimport { useModal } from \"./../contexts/ModalContext\";\r\nimport ModalAddMember from \"./ModalAddMember\";\r\nimport { Input } from \"@material-ui/core\";\r\nimport UserStatusOnProfileSidebar from \"./UserStatusOnProfileSidebar\";\r\nimport ChangeGroupNameButton from \"./ChangeGroupNameButton\";\r\nimport LeaveGroupButton from \"./LeaveGroupButton\";\r\nimport InfoHeadOnSidebar from \"./InfoHeadOnSidebar\";\r\nimport MembersOnSidebar from \"./MembersOnSidebar\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport Swal from \"sweetalert2\";\r\nimport { ModalEditConference } from \"./ModalEditConference\";\r\nimport { useConference } from \"../contexts/ConferenceContext\";\r\nimport ChatType from \"../enuns/ChatType\";\r\n\r\ninterface IProps {\r\n  show: boolean;\r\n  setShow(value: boolean): void;\r\n}\r\n\r\nconst ChatProfileSidebar: React.FC<IProps> = ({ show, setShow }) => {\r\n  const { t } = useTranslation();\r\n  const [isOpen1, setIsOpen1] = useState(true);\r\n  const [isOpen2, setIsOpen2] = useState(false);\r\n  const [newGroupName, setGroupName] = useState(\"\");\r\n  const { user } = useAuth();\r\n  const { activeChat, chats, setChats, setActiveChat } = useChat();\r\n  const { groups, setGroups } = useGroup();\r\n  const { contacts, setContacts } = useContact();\r\n  const { setShowModalAddMember } = useModal();\r\n  const [showModal, setShowModal] = useState(false);\r\n  const { setConferenceToRemove, conferenceList } = useConference();\r\n  const toggleCollapse1 = () => {\r\n    setIsOpen1(!isOpen1);\r\n  };\r\n\r\n  const toggleCollapse2 = () => {\r\n    setIsOpen2(!isOpen2);\r\n  };\r\n\r\n  const closeUserSidebar = () => {\r\n    setShow(false);\r\n  };\r\n\r\n  const getAttachedFiles = () => {\r\n    if (show && activeChat.attachedFileList === undefined) {\r\n      setActiveChat({ ...activeChat, attachedFileList: [] });\r\n    } else if (!show) {\r\n      setActiveChat({ ...activeChat, attachedFileList: undefined });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    getAttachedFiles(); // eslint-disable-next-line\r\n    setShowModal(false); // eslint-disable-next-line\r\n  }, [show]);\r\n\r\n  const closeUserSidebarOnActiveChatChange = () => {\r\n    if (show && activeChat.attachedFileList === undefined) closeUserSidebar();\r\n  };\r\n\r\n  useEffect(closeUserSidebarOnActiveChatChange, [activeChat]);\r\n  const actualMember = activeChat.members?.find(\r\n    (member) => member.userId === user.id\r\n  );\r\n\r\n  const isAdmin = actualMember?.role === \"admin\";\r\n  //const groupAdmins = activeChat.members?.filter((member) => member.role === \"admin\");\r\n  const actualMembers = activeChat.members?.map((mb) => {\r\n    return mb.userId;\r\n  });\r\n\r\n  const isGroup = activeChat.groupId;\r\n\r\n  const membersArrayPreventingDuplicateDisplayMember =\r\n    activeChat.chatType === ChatType.GROUP\r\n      ? activeChat.members?.filter(\r\n          (item, index, arrayCompleto) =>\r\n            arrayCompleto.findIndex((item2) => item.userId === item2.userId) ===\r\n            index\r\n        )\r\n      : activeChat.conferenceRoomParticipants;\r\n\r\n  function swDelete() {\r\n    Swal.fire({\r\n      title: t(`Do you want to delete the group '${activeChat.name}' ?`),\r\n      text: \"\",\r\n      icon: \"warning\",\r\n      showCancelButton: true,\r\n      confirmButtonColor: \"#3085d6\",\r\n      cancelButtonColor: \"#d33\",\r\n      confirmButtonText: t(\"Yes\"),\r\n      cancelButtonText: t(\"No\"),\r\n      customClass: {\r\n        popup: \"swal-mini-popup\",\r\n      },\r\n    }).then((result) => {\r\n      if (result.isConfirmed) {\r\n        const conferenceData = conferenceList.find(\r\n          (conference) => conference.jid === activeChat.jid\r\n        );\r\n        if (conferenceData) setConferenceToRemove(conferenceData);\r\n        Swal.fire({\r\n          position: \"center\",\r\n          icon: \"success\",\r\n          title: t(\"Deleted!\"),\r\n          showConfirmButton: false,\r\n          timer: 1500,\r\n          customClass: {\r\n            popup: \"swal-mini-popup\",\r\n          },\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <ModalEditConference\r\n        show={showModal}\r\n        toggle={() => setShowModal(!showModal)}\r\n      />\r\n      <div\r\n        style={{ display: show ? \"block\" : \"none\" }}\r\n        className=\"user-profile-sidebar \"\r\n      >\r\n        <div className=\"d-flex\" style={{ justifyContent: \"center\" }}>\r\n          {isGroup && isAdmin && (\r\n            <div className=\"px-3 px-lg-4 pt-3 pt-lg-4\">\r\n              <div className=\"user-chat-nav text-right\">\r\n                <Button\r\n                  color=\"none\"\r\n                  type=\"button\"\r\n                  className=\"nav-btn\"\r\n                  onClick={() => setShowModalAddMember(true)}\r\n                >\r\n                  <i className=\"ri-user-add-line\"></i>\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n          <ModalAddMember />\r\n          {isGroup && (\r\n            <LeaveGroupButton\r\n              activeChat={activeChat}\r\n              actualMember={actualMember}\r\n            />\r\n          )}\r\n          {isGroup && (\r\n            <div className=\"px-3 px-lg-4 pt-3 pt-lg-4\">\r\n              <div className=\"user-chat-nav text-right\">\r\n                <Button\r\n                  color=\"none\"\r\n                  type=\"button\"\r\n                  onClick={closeUserSidebar}\r\n                  className=\"nav-btn\"\r\n                  id=\"user-profile-hide\"\r\n                >\r\n                  <i className=\"ri-close-line\"></i>\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className=\"text-center px-4 pt-4 pb-3\">\r\n          <div className=\"mb-4 d-flex justify-content-center\">\r\n            {!activeChat.profilePicture ? (\r\n              <div className=\"avatar-lg\">\r\n                <span className=\"avatar-title rounded-circle bg-soft-primary text-primary font-size-24\">\r\n                  {activeChat.name.trim().charAt(0)}\r\n                </span>\r\n              </div>\r\n            ) : (\r\n              <ReactImageFallback\r\n                src={activeChat.profilePicture}\r\n                onError={() => {\r\n                  if (activeChat.jid.includes(\"@conference.\"))\r\n                    onImgError(\r\n                      chats,\r\n                      groups,\r\n                      contacts,\r\n                      setChats,\r\n                      setGroups,\r\n                      setContacts,\r\n                      activeChat\r\n                    );\r\n                }}\r\n                fallbackImage={defaultAvatar}\r\n                className=\"rounded-circle avatar-lg img-thumbnail\"\r\n                alt=\"chatvia\"\r\n              />\r\n            )}\r\n          </div>\r\n          <div className=\"d-flex justify-content-center\">\r\n            {isGroup ? (\r\n              <Input\r\n                inputProps={{ min: 0, style: { textAlign: \"center\" } }}\r\n                placeholder={activeChat.name}\r\n                disableUnderline\r\n                fullWidth\r\n                onChange={(e) => setGroupName(e.target.value)}\r\n              />\r\n            ) : (\r\n              <div>{activeChat.name}</div>\r\n            )}\r\n          </div>\r\n          {isGroup && newGroupName.length > 0 ? (\r\n            <ChangeGroupNameButton\r\n              newGroupName={newGroupName}\r\n              setGroupName={setGroupName}\r\n              actualMembers={actualMembers}\r\n            />\r\n          ) : (\r\n            isGroup && <i className=\"ri-edit-line\"></i>\r\n          )}\r\n          {activeChat.status && <UserStatusOnProfileSidebar />}\r\n        </div>\r\n        <SimpleBar\r\n          style={{ maxHeight: \"100%\" }}\r\n          className=\"px-4 py-2 user-profile-desc\"\r\n        >\r\n          <div id=\"profile-user-accordion\" className=\"custom-accordion\">\r\n            <InfoHeadOnSidebar\r\n              activeChat={activeChat}\r\n              toggleCollapse1={toggleCollapse1}\r\n              isOpen1={isOpen1}\r\n            />\r\n\r\n            {activeChat.jid.includes(\"@conference.\") && (\r\n              <MembersOnSidebar\r\n                isAdmin={isAdmin}\r\n                isOpen2={isOpen2}\r\n                defaultAvatar={defaultAvatar}\r\n                toggleCollapse2={toggleCollapse2}\r\n                membersArrayPreventingDuplicateDisplayMember={\r\n                  membersArrayPreventingDuplicateDisplayMember\r\n                }\r\n              />\r\n            )}\r\n\r\n            <AttachedFilesOnSidebar />\r\n\r\n            {activeChat.chatType === ChatType.CONFERENCE && (\r\n              <>\r\n                <div className=\"d-flex justify-content-center my-3\">\r\n                  <button\r\n                    className=\"btn btn-primary btn-block\"\r\n                    onClick={() => setShowModal(true)}\r\n                  >\r\n                    <div>{t(\"Edit group\")}</div>\r\n                  </button>\r\n                </div>\r\n\r\n                <div className=\"d-flex justify-content-center\">\r\n                  <button\r\n                    className=\"btn btn-danger btn-block\"\r\n                    onClick={swDelete}\r\n                  >\r\n                    <div>{t(\"Delete group\")}</div>\r\n                  </button>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </SimpleBar>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default ChatProfileSidebar;\r\n"]},"metadata":{},"sourceType":"module"}