{"ast":null,"code":"import SquadChatCommunicator from \"./SquadChatCommunicator\";\nimport API from \"@digivox/apicommunicator\";\nimport { getAuthorization } from \"./utils/localStorageUtils\";\nimport SettingsBusiness from \"./business/Settings\";\nimport ContactsBusiness from \"./business/Contacts\";\nimport GroupsBusiness from \"./business/Groups\";\nimport ChatsBusiness from \"./business/Chats\";\nimport MessagesBusiness from \"./business/Messages\";\nimport UserBusiness from \"./business/User\";\nimport AttachmentsBusiness from \"./business/Attachments\";\nimport SquadVoiceCommunicator from \"./SquadVoiceCommunicator\";\nexport class SquadCommunicator {\n  static getInstance(chatCommunicatorSubscribe, voiceCB) {\n    if (!this.instance) {\n      this.instance = new SquadCommunicator();\n    }\n\n    this.instance.updateSubscribeFunction(chatCommunicatorSubscribe, voiceCB);\n    this.instance.makeAPI();\n    return this.instance;\n  }\n\n  updateSubscribeFunction(chatCommunicatorSubscribe, voiceCB) {\n    var _this$chat, _this$chat2, _this$sip;\n\n    (_this$chat = this.chat) === null || _this$chat === void 0 ? void 0 : _this$chat.removeAllSubscription();\n    (_this$chat2 = this.chat) === null || _this$chat2 === void 0 ? void 0 : _this$chat2.subscribe(chatCommunicatorSubscribe);\n    (_this$sip = this.sip) === null || _this$sip === void 0 ? void 0 : _this$sip.subscribe(voiceCB);\n  } // -- Make Services --\n\n\n  makeAPI() {\n    const authorization = getAuthorization();\n\n    if (authorization) {\n      const api = new API({\n        token: authorization.access_token,\n        apiUrl: authorization.baseUrl\n      });\n      this.api = api;\n      this.makeBusiness();\n    }\n  }\n\n  makeBusiness() {\n    if (!this.api) return;\n    this.settings = new SettingsBusiness(this.api);\n    this.user = new UserBusiness(this.api, this.settings);\n    this.contacts = new ContactsBusiness(this.api, this.settings);\n    this.groups = new GroupsBusiness(this.api, this.settings, this.contacts);\n    this.chats = new ChatsBusiness(this.api, this.contacts, this.groups, this.user);\n    this.messages = new MessagesBusiness(this.api, this.contacts, this.groups, this.user);\n    this.attachments = new AttachmentsBusiness(this.api, this.settings);\n    this.chat = new SquadChatCommunicator(this.settings, this.contacts, this.groups, this.user, this.interfaceChatCommunicatorSubscribe);\n    this.sip = new SquadVoiceCommunicator(this.settings, this.interfaceVoiceCommunicatorSubscribe);\n  }\n\n}\nSquadCommunicator.instance = void 0;","map":{"version":3,"sources":["C:/Users/Digivox/dev/Digivox/Refatoracao/squad/src/services/SquadCommunicatorService.ts"],"names":["SquadChatCommunicator","API","getAuthorization","SettingsBusiness","ContactsBusiness","GroupsBusiness","ChatsBusiness","MessagesBusiness","UserBusiness","AttachmentsBusiness","SquadVoiceCommunicator","SquadCommunicator","getInstance","chatCommunicatorSubscribe","voiceCB","instance","updateSubscribeFunction","makeAPI","chat","removeAllSubscription","subscribe","sip","authorization","api","token","access_token","apiUrl","baseUrl","makeBusiness","settings","user","contacts","groups","chats","messages","attachments","interfaceChatCommunicatorSubscribe","interfaceVoiceCommunicatorSubscribe"],"mappings":"AAAA,OAAOA,qBAAP,MAAkC,yBAAlC;AACA,OAAOC,GAAP,MAAgB,0BAAhB;AAGA,SAASC,gBAAT,QAAiC,2BAAjC;AACA,OAAOC,gBAAP,MAA6B,qBAA7B;AACA,OAAOC,gBAAP,MAA6B,qBAA7B;AACA,OAAOC,cAAP,MAA2B,mBAA3B;AACA,OAAOC,aAAP,MAA0B,kBAA1B;AACA,OAAOC,gBAAP,MAA6B,qBAA7B;AACA,OAAOC,YAAP,MAAyB,iBAAzB;AACA,OAAOC,mBAAP,MAAgC,wBAAhC;AACA,OAAOC,sBAAP,MAAmC,0BAAnC;AAiBA,OAAO,MAAMC,iBAAN,CAAwB;AAE7B,SAAOC,WAAP,CACEC,yBADF,EAEEC,OAFF,EAGE;AACA,QAAI,CAAC,KAAKC,QAAV,EAAoB;AAClB,WAAKA,QAAL,GAAgB,IAAIJ,iBAAJ,EAAhB;AACD;;AACD,SAAKI,QAAL,CAAcC,uBAAd,CAAsCH,yBAAtC,EAAiEC,OAAjE;AACA,SAAKC,QAAL,CAAcE,OAAd;AACA,WAAO,KAAKF,QAAZ;AACD;;AACDC,EAAAA,uBAAuB,CACrBH,yBADqB,EAErBC,OAFqB,EAGrB;AAAA;;AACA,uBAAKI,IAAL,0DAAWC,qBAAX;AACA,wBAAKD,IAAL,4DAAWE,SAAX,CAAqBP,yBAArB;AACA,sBAAKQ,GAAL,wDAAUD,SAAV,CAAoBN,OAApB;AACD,GApB4B,CAqB7B;;;AACAG,EAAAA,OAAO,GAAG;AACR,UAAMK,aAAa,GAAGpB,gBAAgB,EAAtC;;AACA,QAAIoB,aAAJ,EAAmB;AACjB,YAAMC,GAAG,GAAG,IAAItB,GAAJ,CAAQ;AAClBuB,QAAAA,KAAK,EAAEF,aAAa,CAACG,YADH;AAElBC,QAAAA,MAAM,EAAEJ,aAAa,CAACK;AAFJ,OAAR,CAAZ;AAIA,WAAKJ,GAAL,GAAWA,GAAX;AACA,WAAKK,YAAL;AACD;AACF;;AACDA,EAAAA,YAAY,GAAG;AACb,QAAI,CAAC,KAAKL,GAAV,EAAe;AACf,SAAKM,QAAL,GAAgB,IAAI1B,gBAAJ,CAAqB,KAAKoB,GAA1B,CAAhB;AACA,SAAKO,IAAL,GAAY,IAAItB,YAAJ,CAAiB,KAAKe,GAAtB,EAA2B,KAAKM,QAAhC,CAAZ;AACA,SAAKE,QAAL,GAAgB,IAAI3B,gBAAJ,CAAqB,KAAKmB,GAA1B,EAA+B,KAAKM,QAApC,CAAhB;AACA,SAAKG,MAAL,GAAc,IAAI3B,cAAJ,CAAmB,KAAKkB,GAAxB,EAA6B,KAAKM,QAAlC,EAA4C,KAAKE,QAAjD,CAAd;AACA,SAAKE,KAAL,GAAa,IAAI3B,aAAJ,CACX,KAAKiB,GADM,EAEX,KAAKQ,QAFM,EAGX,KAAKC,MAHM,EAIX,KAAKF,IAJM,CAAb;AAMA,SAAKI,QAAL,GAAgB,IAAI3B,gBAAJ,CACd,KAAKgB,GADS,EAEd,KAAKQ,QAFS,EAGd,KAAKC,MAHS,EAId,KAAKF,IAJS,CAAhB;AAMA,SAAKK,WAAL,GAAmB,IAAI1B,mBAAJ,CAAwB,KAAKc,GAA7B,EAAkC,KAAKM,QAAvC,CAAnB;AACA,SAAKX,IAAL,GAAY,IAAIlB,qBAAJ,CACV,KAAK6B,QADK,EAEV,KAAKE,QAFK,EAGV,KAAKC,MAHK,EAIV,KAAKF,IAJK,EAKV,KAAKM,kCALK,CAAZ;AAOA,SAAKf,GAAL,GAAW,IAAIX,sBAAJ,CACT,KAAKmB,QADI,EAET,KAAKQ,mCAFI,CAAX;AAID;;AA/D4B;AAAlB1B,iB,CACII,Q","sourcesContent":["import SquadChatCommunicator from \"./SquadChatCommunicator\";\r\nimport API from \"@digivox/apicommunicator\";\r\nimport { SubscriptionCallBack } from \"./types\";\r\nimport { SubscriptionCallBack as VoiceCB } from \"./voice/types\";\r\nimport { getAuthorization } from \"./utils/localStorageUtils\";\r\nimport SettingsBusiness from \"./business/Settings\";\r\nimport ContactsBusiness from \"./business/Contacts\";\r\nimport GroupsBusiness from \"./business/Groups\";\r\nimport ChatsBusiness from \"./business/Chats\";\r\nimport MessagesBusiness from \"./business/Messages\";\r\nimport UserBusiness from \"./business/User\";\r\nimport AttachmentsBusiness from \"./business/Attachments\";\r\nimport SquadVoiceCommunicator from \"./SquadVoiceCommunicator\";\r\n\r\nexport interface SquadCommunicator {\r\n  interfaceChatCommunicatorSubscribe: SubscriptionCallBack;\r\n  interfaceVoiceCommunicatorSubscribe: VoiceCB;\r\n  getInstance(): SquadCommunicator;\r\n  api: API | undefined;\r\n  chat: SquadChatCommunicator | undefined;\r\n  settings: SettingsBusiness;\r\n  contacts: ContactsBusiness;\r\n  groups: GroupsBusiness;\r\n  chats: ChatsBusiness;\r\n  messages: MessagesBusiness;\r\n  user: UserBusiness;\r\n  attachments: AttachmentsBusiness;\r\n  sip: SquadVoiceCommunicator;\r\n}\r\nexport class SquadCommunicator {\r\n  private static instance: SquadCommunicator | undefined;\r\n  static getInstance(\r\n    chatCommunicatorSubscribe: SubscriptionCallBack,\r\n    voiceCB: VoiceCB\r\n  ) {\r\n    if (!this.instance) {\r\n      this.instance = new SquadCommunicator();\r\n    }\r\n    this.instance.updateSubscribeFunction(chatCommunicatorSubscribe, voiceCB);\r\n    this.instance.makeAPI();\r\n    return this.instance;\r\n  }\r\n  updateSubscribeFunction(\r\n    chatCommunicatorSubscribe: SubscriptionCallBack,\r\n    voiceCB: VoiceCB\r\n  ) {\r\n    this.chat?.removeAllSubscription();\r\n    this.chat?.subscribe(chatCommunicatorSubscribe);\r\n    this.sip?.subscribe(voiceCB);\r\n  }\r\n  // -- Make Services --\r\n  makeAPI() {\r\n    const authorization = getAuthorization();\r\n    if (authorization) {\r\n      const api = new API({\r\n        token: authorization.access_token,\r\n        apiUrl: authorization.baseUrl,\r\n      });\r\n      this.api = api;\r\n      this.makeBusiness();\r\n    }\r\n  }\r\n  makeBusiness() {\r\n    if (!this.api) return;\r\n    this.settings = new SettingsBusiness(this.api);\r\n    this.user = new UserBusiness(this.api, this.settings);\r\n    this.contacts = new ContactsBusiness(this.api, this.settings);\r\n    this.groups = new GroupsBusiness(this.api, this.settings, this.contacts);\r\n    this.chats = new ChatsBusiness(\r\n      this.api,\r\n      this.contacts,\r\n      this.groups,\r\n      this.user\r\n    );\r\n    this.messages = new MessagesBusiness(\r\n      this.api,\r\n      this.contacts,\r\n      this.groups,\r\n      this.user\r\n    );\r\n    this.attachments = new AttachmentsBusiness(this.api, this.settings);\r\n    this.chat = new SquadChatCommunicator(\r\n      this.settings,\r\n      this.contacts,\r\n      this.groups,\r\n      this.user,\r\n      this.interfaceChatCommunicatorSubscribe\r\n    );\r\n    this.sip = new SquadVoiceCommunicator(\r\n      this.settings,\r\n      this.interfaceVoiceCommunicatorSubscribe\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}