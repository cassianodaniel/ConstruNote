{"ast":null,"code":"import { CanonicalizeLocaleList } from '../CanonicalizeLocaleList';\nimport { ToDateTimeOptions } from './ToDateTimeOptions';\nimport { GetOption } from '../GetOption';\nimport { ResolveLocale } from '../ResolveLocale';\nimport { IsValidTimeZoneName } from '../IsValidTimeZoneName';\nimport { CanonicalizeTimeZoneName } from '../CanonicalizeTimeZoneName';\nimport { BasicFormatMatcher } from './BasicFormatMatcher';\nimport { BestFitFormatMatcher } from './BestFitFormatMatcher';\nimport { invariant } from '../utils';\nimport { DATE_TIME_PROPS } from './utils';\nimport { DateTimeStyleFormat } from './DateTimeStyleFormat';\n\nfunction isTimeRelated(opt) {\n  for (var _i = 0, _a = ['hour', 'minute', 'second']; _i < _a.length; _i++) {\n    var prop = _a[_i];\n    var value = opt[prop];\n\n    if (value !== undefined) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction resolveHourCycle(hc, hcDefault, hour12) {\n  if (hc == null) {\n    hc = hcDefault;\n  }\n\n  if (hour12 !== undefined) {\n    if (hour12) {\n      if (hcDefault === 'h11' || hcDefault === 'h23') {\n        hc = 'h11';\n      } else {\n        hc = 'h12';\n      }\n    } else {\n      invariant(!hour12, 'hour12 must not be set');\n\n      if (hcDefault === 'h11' || hcDefault === 'h23') {\n        hc = 'h23';\n      } else {\n        hc = 'h24';\n      }\n    }\n  }\n\n  return hc;\n}\n\nvar TYPE_REGEX = /^[a-z0-9]{3,8}$/i;\n/**\n * https://tc39.es/ecma402/#sec-initializedatetimeformat\n * @param dtf DateTimeFormat\n * @param locales locales\n * @param opts options\n */\n\nexport function InitializeDateTimeFormat(dtf, locales, opts, _a) {\n  var getInternalSlots = _a.getInternalSlots,\n      availableLocales = _a.availableLocales,\n      localeData = _a.localeData,\n      getDefaultLocale = _a.getDefaultLocale,\n      getDefaultTimeZone = _a.getDefaultTimeZone,\n      relevantExtensionKeys = _a.relevantExtensionKeys,\n      tzData = _a.tzData,\n      uppercaseLinks = _a.uppercaseLinks; // @ts-ignore\n\n  var requestedLocales = CanonicalizeLocaleList(locales);\n  var options = ToDateTimeOptions(opts, 'any', 'date');\n  var opt = Object.create(null);\n  var matcher = GetOption(options, 'localeMatcher', 'string', ['lookup', 'best fit'], 'best fit');\n  opt.localeMatcher = matcher;\n  var calendar = GetOption(options, 'calendar', 'string', undefined, undefined);\n\n  if (calendar !== undefined && !TYPE_REGEX.test(calendar)) {\n    throw new RangeError('Malformed calendar');\n  }\n\n  var internalSlots = getInternalSlots(dtf);\n  opt.ca = calendar;\n  var numberingSystem = GetOption(options, 'numberingSystem', 'string', undefined, undefined);\n\n  if (numberingSystem !== undefined && !TYPE_REGEX.test(numberingSystem)) {\n    throw new RangeError('Malformed numbering system');\n  }\n\n  opt.nu = numberingSystem;\n  var hour12 = GetOption(options, 'hour12', 'boolean', undefined, undefined);\n  var hourCycle = GetOption(options, 'hourCycle', 'string', ['h11', 'h12', 'h23', 'h24'], undefined);\n\n  if (hour12 !== undefined) {\n    // @ts-ignore\n    hourCycle = null;\n  }\n\n  opt.hc = hourCycle;\n  var r = ResolveLocale(availableLocales, requestedLocales, opt, relevantExtensionKeys, localeData, getDefaultLocale);\n  internalSlots.locale = r.locale;\n  calendar = r.ca;\n  internalSlots.calendar = calendar;\n  internalSlots.hourCycle = r.hc;\n  internalSlots.numberingSystem = r.nu;\n  var dataLocale = r.dataLocale;\n  internalSlots.dataLocale = dataLocale;\n  var timeZone = options.timeZone;\n\n  if (timeZone !== undefined) {\n    timeZone = String(timeZone);\n\n    if (!IsValidTimeZoneName(timeZone, {\n      tzData: tzData,\n      uppercaseLinks: uppercaseLinks\n    })) {\n      throw new RangeError('Invalid timeZoneName');\n    }\n\n    timeZone = CanonicalizeTimeZoneName(timeZone, {\n      tzData: tzData,\n      uppercaseLinks: uppercaseLinks\n    });\n  } else {\n    timeZone = getDefaultTimeZone();\n  }\n\n  internalSlots.timeZone = timeZone;\n  opt = Object.create(null);\n  opt.weekday = GetOption(options, 'weekday', 'string', ['narrow', 'short', 'long'], undefined);\n  opt.era = GetOption(options, 'era', 'string', ['narrow', 'short', 'long'], undefined);\n  opt.year = GetOption(options, 'year', 'string', ['2-digit', 'numeric'], undefined);\n  opt.month = GetOption(options, 'month', 'string', ['2-digit', 'numeric', 'narrow', 'short', 'long'], undefined);\n  opt.day = GetOption(options, 'day', 'string', ['2-digit', 'numeric'], undefined);\n  opt.hour = GetOption(options, 'hour', 'string', ['2-digit', 'numeric'], undefined);\n  opt.minute = GetOption(options, 'minute', 'string', ['2-digit', 'numeric'], undefined);\n  opt.second = GetOption(options, 'second', 'string', ['2-digit', 'numeric'], undefined);\n  opt.timeZoneName = GetOption(options, 'timeZoneName', 'string', ['short', 'long'], undefined);\n  var dataLocaleData = localeData[dataLocale];\n  invariant(!!dataLocaleData, \"Missing locale data for \" + dataLocale);\n  var formats = dataLocaleData.formats[calendar]; // UNSPECCED: IMPLEMENTATION DETAILS\n\n  if (!formats) {\n    throw new RangeError(\"Calendar \\\"\" + calendar + \"\\\" is not supported. Try setting \\\"calendar\\\" to 1 of the following: \" + Object.keys(dataLocaleData.formats).join(', '));\n  }\n\n  matcher = GetOption(options, 'formatMatcher', 'string', ['basic', 'best fit'], 'best fit');\n  var dateStyle = GetOption(options, 'dateStyle', 'string', ['full', 'long', 'medium', 'short'], undefined);\n  internalSlots.dateStyle = dateStyle;\n  var timeStyle = GetOption(options, 'timeStyle', 'string', ['full', 'long', 'medium', 'short'], undefined);\n  internalSlots.timeStyle = timeStyle;\n  var bestFormat;\n\n  if (dateStyle === undefined && timeStyle === undefined) {\n    if (matcher === 'basic') {\n      bestFormat = BasicFormatMatcher(opt, formats);\n    } else {\n      // IMPL DETAILS START\n      if (isTimeRelated(opt)) {\n        var hc = resolveHourCycle(internalSlots.hourCycle, dataLocaleData.hourCycle, hour12);\n        opt.hour12 = hc === 'h11' || hc === 'h12';\n      } // IMPL DETAILS END\n\n\n      bestFormat = BestFitFormatMatcher(opt, formats);\n    }\n  } else {\n    for (var _i = 0, DATE_TIME_PROPS_1 = DATE_TIME_PROPS; _i < DATE_TIME_PROPS_1.length; _i++) {\n      var prop = DATE_TIME_PROPS_1[_i];\n      var p = opt[prop];\n\n      if (p !== undefined) {\n        throw new TypeError(\"Intl.DateTimeFormat can't set option \" + prop + \" when \" + (dateStyle ? 'dateStyle' : 'timeStyle') + \" is used\");\n      }\n    }\n\n    bestFormat = DateTimeStyleFormat(dateStyle, timeStyle, dataLocaleData);\n  } // IMPL DETAIL START\n  // For debugging\n\n\n  internalSlots.format = bestFormat; // IMPL DETAIL END\n\n  for (var prop in opt) {\n    var p = bestFormat[prop];\n\n    if (p !== undefined) {\n      internalSlots[prop] = p;\n    }\n  }\n\n  var pattern;\n  var rangePatterns;\n\n  if (internalSlots.hour !== undefined) {\n    var hc = resolveHourCycle(internalSlots.hourCycle, dataLocaleData.hourCycle, hour12);\n    internalSlots.hourCycle = hc;\n\n    if (hc === 'h11' || hc === 'h12') {\n      pattern = bestFormat.pattern12;\n      rangePatterns = bestFormat.rangePatterns12;\n    } else {\n      pattern = bestFormat.pattern;\n      rangePatterns = bestFormat.rangePatterns;\n    }\n  } else {\n    // @ts-ignore\n    internalSlots.hourCycle = undefined;\n    pattern = bestFormat.pattern;\n    rangePatterns = bestFormat.rangePatterns;\n  }\n\n  internalSlots.pattern = pattern;\n  internalSlots.rangePatterns = rangePatterns;\n  return dtf;\n}","map":{"version":3,"sources":["C:/Users/Digivox/dev/Digivox/Refatoracao/squad/node_modules/@formatjs/ecma402-abstract/lib/src/DateTimeFormat/InitializeDateTimeFormat.js"],"names":["CanonicalizeLocaleList","ToDateTimeOptions","GetOption","ResolveLocale","IsValidTimeZoneName","CanonicalizeTimeZoneName","BasicFormatMatcher","BestFitFormatMatcher","invariant","DATE_TIME_PROPS","DateTimeStyleFormat","isTimeRelated","opt","_i","_a","length","prop","value","undefined","resolveHourCycle","hc","hcDefault","hour12","TYPE_REGEX","InitializeDateTimeFormat","dtf","locales","opts","getInternalSlots","availableLocales","localeData","getDefaultLocale","getDefaultTimeZone","relevantExtensionKeys","tzData","uppercaseLinks","requestedLocales","options","Object","create","matcher","localeMatcher","calendar","test","RangeError","internalSlots","ca","numberingSystem","nu","hourCycle","r","locale","dataLocale","timeZone","String","weekday","era","year","month","day","hour","minute","second","timeZoneName","dataLocaleData","formats","keys","join","dateStyle","timeStyle","bestFormat","DATE_TIME_PROPS_1","p","TypeError","format","pattern","rangePatterns","pattern12","rangePatterns12"],"mappings":"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","sourcesContent":["import { CanonicalizeLocaleList } from '../CanonicalizeLocaleList';\nimport { ToDateTimeOptions } from './ToDateTimeOptions';\nimport { GetOption } from '../GetOption';\nimport { ResolveLocale } from '../ResolveLocale';\nimport { IsValidTimeZoneName } from '../IsValidTimeZoneName';\nimport { CanonicalizeTimeZoneName } from '../CanonicalizeTimeZoneName';\nimport { BasicFormatMatcher } from './BasicFormatMatcher';\nimport { BestFitFormatMatcher } from './BestFitFormatMatcher';\nimport { invariant } from '../utils';\nimport { DATE_TIME_PROPS } from './utils';\nimport { DateTimeStyleFormat } from './DateTimeStyleFormat';\nfunction isTimeRelated(opt) {\n    for (var _i = 0, _a = ['hour', 'minute', 'second']; _i < _a.length; _i++) {\n        var prop = _a[_i];\n        var value = opt[prop];\n        if (value !== undefined) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction resolveHourCycle(hc, hcDefault, hour12) {\n    if (hc == null) {\n        hc = hcDefault;\n    }\n    if (hour12 !== undefined) {\n        if (hour12) {\n            if (hcDefault === 'h11' || hcDefault === 'h23') {\n                hc = 'h11';\n            }\n            else {\n                hc = 'h12';\n            }\n        }\n        else {\n            invariant(!hour12, 'hour12 must not be set');\n            if (hcDefault === 'h11' || hcDefault === 'h23') {\n                hc = 'h23';\n            }\n            else {\n                hc = 'h24';\n            }\n        }\n    }\n    return hc;\n}\nvar TYPE_REGEX = /^[a-z0-9]{3,8}$/i;\n/**\n * https://tc39.es/ecma402/#sec-initializedatetimeformat\n * @param dtf DateTimeFormat\n * @param locales locales\n * @param opts options\n */\nexport function InitializeDateTimeFormat(dtf, locales, opts, _a) {\n    var getInternalSlots = _a.getInternalSlots, availableLocales = _a.availableLocales, localeData = _a.localeData, getDefaultLocale = _a.getDefaultLocale, getDefaultTimeZone = _a.getDefaultTimeZone, relevantExtensionKeys = _a.relevantExtensionKeys, tzData = _a.tzData, uppercaseLinks = _a.uppercaseLinks;\n    // @ts-ignore\n    var requestedLocales = CanonicalizeLocaleList(locales);\n    var options = ToDateTimeOptions(opts, 'any', 'date');\n    var opt = Object.create(null);\n    var matcher = GetOption(options, 'localeMatcher', 'string', ['lookup', 'best fit'], 'best fit');\n    opt.localeMatcher = matcher;\n    var calendar = GetOption(options, 'calendar', 'string', undefined, undefined);\n    if (calendar !== undefined && !TYPE_REGEX.test(calendar)) {\n        throw new RangeError('Malformed calendar');\n    }\n    var internalSlots = getInternalSlots(dtf);\n    opt.ca = calendar;\n    var numberingSystem = GetOption(options, 'numberingSystem', 'string', undefined, undefined);\n    if (numberingSystem !== undefined && !TYPE_REGEX.test(numberingSystem)) {\n        throw new RangeError('Malformed numbering system');\n    }\n    opt.nu = numberingSystem;\n    var hour12 = GetOption(options, 'hour12', 'boolean', undefined, undefined);\n    var hourCycle = GetOption(options, 'hourCycle', 'string', ['h11', 'h12', 'h23', 'h24'], undefined);\n    if (hour12 !== undefined) {\n        // @ts-ignore\n        hourCycle = null;\n    }\n    opt.hc = hourCycle;\n    var r = ResolveLocale(availableLocales, requestedLocales, opt, relevantExtensionKeys, localeData, getDefaultLocale);\n    internalSlots.locale = r.locale;\n    calendar = r.ca;\n    internalSlots.calendar = calendar;\n    internalSlots.hourCycle = r.hc;\n    internalSlots.numberingSystem = r.nu;\n    var dataLocale = r.dataLocale;\n    internalSlots.dataLocale = dataLocale;\n    var timeZone = options.timeZone;\n    if (timeZone !== undefined) {\n        timeZone = String(timeZone);\n        if (!IsValidTimeZoneName(timeZone, { tzData: tzData, uppercaseLinks: uppercaseLinks })) {\n            throw new RangeError('Invalid timeZoneName');\n        }\n        timeZone = CanonicalizeTimeZoneName(timeZone, { tzData: tzData, uppercaseLinks: uppercaseLinks });\n    }\n    else {\n        timeZone = getDefaultTimeZone();\n    }\n    internalSlots.timeZone = timeZone;\n    opt = Object.create(null);\n    opt.weekday = GetOption(options, 'weekday', 'string', ['narrow', 'short', 'long'], undefined);\n    opt.era = GetOption(options, 'era', 'string', ['narrow', 'short', 'long'], undefined);\n    opt.year = GetOption(options, 'year', 'string', ['2-digit', 'numeric'], undefined);\n    opt.month = GetOption(options, 'month', 'string', ['2-digit', 'numeric', 'narrow', 'short', 'long'], undefined);\n    opt.day = GetOption(options, 'day', 'string', ['2-digit', 'numeric'], undefined);\n    opt.hour = GetOption(options, 'hour', 'string', ['2-digit', 'numeric'], undefined);\n    opt.minute = GetOption(options, 'minute', 'string', ['2-digit', 'numeric'], undefined);\n    opt.second = GetOption(options, 'second', 'string', ['2-digit', 'numeric'], undefined);\n    opt.timeZoneName = GetOption(options, 'timeZoneName', 'string', ['short', 'long'], undefined);\n    var dataLocaleData = localeData[dataLocale];\n    invariant(!!dataLocaleData, \"Missing locale data for \" + dataLocale);\n    var formats = dataLocaleData.formats[calendar];\n    // UNSPECCED: IMPLEMENTATION DETAILS\n    if (!formats) {\n        throw new RangeError(\"Calendar \\\"\" + calendar + \"\\\" is not supported. Try setting \\\"calendar\\\" to 1 of the following: \" + Object.keys(dataLocaleData.formats).join(', '));\n    }\n    matcher = GetOption(options, 'formatMatcher', 'string', ['basic', 'best fit'], 'best fit');\n    var dateStyle = GetOption(options, 'dateStyle', 'string', ['full', 'long', 'medium', 'short'], undefined);\n    internalSlots.dateStyle = dateStyle;\n    var timeStyle = GetOption(options, 'timeStyle', 'string', ['full', 'long', 'medium', 'short'], undefined);\n    internalSlots.timeStyle = timeStyle;\n    var bestFormat;\n    if (dateStyle === undefined && timeStyle === undefined) {\n        if (matcher === 'basic') {\n            bestFormat = BasicFormatMatcher(opt, formats);\n        }\n        else {\n            // IMPL DETAILS START\n            if (isTimeRelated(opt)) {\n                var hc = resolveHourCycle(internalSlots.hourCycle, dataLocaleData.hourCycle, hour12);\n                opt.hour12 = hc === 'h11' || hc === 'h12';\n            }\n            // IMPL DETAILS END\n            bestFormat = BestFitFormatMatcher(opt, formats);\n        }\n    }\n    else {\n        for (var _i = 0, DATE_TIME_PROPS_1 = DATE_TIME_PROPS; _i < DATE_TIME_PROPS_1.length; _i++) {\n            var prop = DATE_TIME_PROPS_1[_i];\n            var p = opt[prop];\n            if (p !== undefined) {\n                throw new TypeError(\"Intl.DateTimeFormat can't set option \" + prop + \" when \" + (dateStyle ? 'dateStyle' : 'timeStyle') + \" is used\");\n            }\n        }\n        bestFormat = DateTimeStyleFormat(dateStyle, timeStyle, dataLocaleData);\n    }\n    // IMPL DETAIL START\n    // For debugging\n    internalSlots.format = bestFormat;\n    // IMPL DETAIL END\n    for (var prop in opt) {\n        var p = bestFormat[prop];\n        if (p !== undefined) {\n            internalSlots[prop] = p;\n        }\n    }\n    var pattern;\n    var rangePatterns;\n    if (internalSlots.hour !== undefined) {\n        var hc = resolveHourCycle(internalSlots.hourCycle, dataLocaleData.hourCycle, hour12);\n        internalSlots.hourCycle = hc;\n        if (hc === 'h11' || hc === 'h12') {\n            pattern = bestFormat.pattern12;\n            rangePatterns = bestFormat.rangePatterns12;\n        }\n        else {\n            pattern = bestFormat.pattern;\n            rangePatterns = bestFormat.rangePatterns;\n        }\n    }\n    else {\n        // @ts-ignore\n        internalSlots.hourCycle = undefined;\n        pattern = bestFormat.pattern;\n        rangePatterns = bestFormat.rangePatterns;\n    }\n    internalSlots.pattern = pattern;\n    internalSlots.rangePatterns = rangePatterns;\n    return dtf;\n}\n"]},"metadata":{},"sourceType":"module"}