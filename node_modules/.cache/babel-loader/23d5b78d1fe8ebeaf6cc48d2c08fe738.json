{"ast":null,"code":"import { CanonicalizeLocaleList } from '../CanonicalizeLocaleList';\nimport { ToDateTimeOptions } from './ToDateTimeOptions';\nimport { GetOption } from '../GetOption';\nimport { ResolveLocale } from '../ResolveLocale';\nimport { IsValidTimeZoneName } from '../IsValidTimeZoneName';\nimport { CanonicalizeTimeZoneName } from '../CanonicalizeTimeZoneName';\nimport { BasicFormatMatcher } from './BasicFormatMatcher';\nimport { BestFitFormatMatcher } from './BestFitFormatMatcher';\nimport { invariant } from '../utils';\nimport { DATE_TIME_PROPS } from './utils';\nimport { DateTimeStyleFormat } from './DateTimeStyleFormat';\n\nfunction isTimeRelated(opt) {\n  for (var _i = 0, _a = ['hour', 'minute', 'second']; _i < _a.length; _i++) {\n    var prop = _a[_i];\n    var value = opt[prop];\n\n    if (value !== undefined) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar TYPE_REGEX = /^[a-z0-9]{3,8}$/i;\n/**\n * https://tc39.es/ecma402/#sec-initializedatetimeformat\n * @param dtf DateTimeFormat\n * @param locales locales\n * @param opts options\n */\n\nexport function InitializeDateTimeFormat(dtf, locales, opts, _a) {\n  var getInternalSlots = _a.getInternalSlots,\n      availableLocales = _a.availableLocales,\n      localeData = _a.localeData,\n      getDefaultLocale = _a.getDefaultLocale,\n      getDefaultTimeZone = _a.getDefaultTimeZone,\n      relevantExtensionKeys = _a.relevantExtensionKeys,\n      tzData = _a.tzData,\n      uppercaseLinks = _a.uppercaseLinks; // @ts-ignore\n\n  var requestedLocales = CanonicalizeLocaleList(locales);\n  var options = ToDateTimeOptions(opts, 'any', 'date');\n  var opt = Object.create(null);\n  var matcher = GetOption(options, 'localeMatcher', 'string', ['lookup', 'best fit'], 'best fit');\n  opt.localeMatcher = matcher;\n  var calendar = GetOption(options, 'calendar', 'string', undefined, undefined);\n\n  if (calendar !== undefined && !TYPE_REGEX.test(calendar)) {\n    throw new RangeError('Malformed calendar');\n  }\n\n  var internalSlots = getInternalSlots(dtf);\n  opt.ca = calendar;\n  var numberingSystem = GetOption(options, 'numberingSystem', 'string', undefined, undefined);\n\n  if (numberingSystem !== undefined && !TYPE_REGEX.test(numberingSystem)) {\n    throw new RangeError('Malformed numbering system');\n  }\n\n  opt.nu = numberingSystem;\n  var hour12 = GetOption(options, 'hour12', 'boolean', undefined, undefined);\n  var hourCycle = GetOption(options, 'hourCycle', 'string', ['h11', 'h12', 'h23', 'h24'], undefined);\n\n  if (hour12 !== undefined) {\n    // @ts-ignore\n    hourCycle = null;\n  }\n\n  opt.hc = hourCycle;\n  var r = ResolveLocale(availableLocales, requestedLocales, opt, relevantExtensionKeys, localeData, getDefaultLocale);\n  internalSlots.locale = r.locale;\n  calendar = r.ca;\n  internalSlots.calendar = calendar;\n  internalSlots.hourCycle = r.hc;\n  internalSlots.numberingSystem = r.nu;\n  var dataLocale = r.dataLocale;\n  internalSlots.dataLocale = dataLocale;\n  var timeZone = options.timeZone;\n\n  if (timeZone !== undefined) {\n    timeZone = String(timeZone);\n\n    if (!IsValidTimeZoneName(timeZone, {\n      tzData: tzData,\n      uppercaseLinks: uppercaseLinks\n    })) {\n      throw new RangeError('Invalid timeZoneName');\n    }\n\n    timeZone = CanonicalizeTimeZoneName(timeZone, {\n      tzData: tzData,\n      uppercaseLinks: uppercaseLinks\n    });\n  } else {\n    timeZone = getDefaultTimeZone();\n  }\n\n  internalSlots.timeZone = timeZone;\n  opt = Object.create(null);\n  opt.weekday = GetOption(options, 'weekday', 'string', ['narrow', 'short', 'long'], undefined);\n  opt.era = GetOption(options, 'era', 'string', ['narrow', 'short', 'long'], undefined);\n  opt.year = GetOption(options, 'year', 'string', ['2-digit', 'numeric'], undefined);\n  opt.month = GetOption(options, 'month', 'string', ['2-digit', 'numeric', 'narrow', 'short', 'long'], undefined);\n  opt.day = GetOption(options, 'day', 'string', ['2-digit', 'numeric'], undefined);\n  opt.hour = GetOption(options, 'hour', 'string', ['2-digit', 'numeric'], undefined);\n  opt.minute = GetOption(options, 'minute', 'string', ['2-digit', 'numeric'], undefined);\n  opt.second = GetOption(options, 'second', 'string', ['2-digit', 'numeric'], undefined);\n  opt.timeZoneName = GetOption(options, 'timeZoneName', 'string', ['short', 'long'], undefined);\n  var dataLocaleData = localeData[dataLocale];\n  invariant(!!dataLocaleData, \"Missing locale data for \" + dataLocale);\n  var formats = dataLocaleData.formats[calendar]; // UNSPECCED: IMPLEMENTATION DETAILS\n\n  if (!formats) {\n    throw new RangeError(\"Calendar \\\"\" + calendar + \"\\\" is not supported. Try setting \\\"calendar\\\" to 1 of the following: \" + Object.keys(dataLocaleData.formats).join(', '));\n  }\n\n  matcher = GetOption(options, 'formatMatcher', 'string', ['basic', 'best fit'], 'best fit');\n  var dateStyle = GetOption(options, 'dateStyle', 'string', ['full', 'long', 'medium', 'short'], undefined);\n  internalSlots.dateStyle = dateStyle;\n  var timeStyle = GetOption(options, 'timeStyle', 'string', ['full', 'long', 'medium', 'short'], undefined);\n  internalSlots.timeStyle = timeStyle;\n  var bestFormat;\n\n  if (dateStyle === undefined && timeStyle === undefined) {\n    if (matcher === 'basic') {\n      bestFormat = BasicFormatMatcher(opt, formats);\n    } else {\n      if (isTimeRelated(opt)) {\n        opt.hour12 = internalSlots.hourCycle === 'h11' || internalSlots.hourCycle === 'h12';\n      }\n\n      bestFormat = BestFitFormatMatcher(opt, formats);\n    }\n  } else {\n    for (var _i = 0, DATE_TIME_PROPS_1 = DATE_TIME_PROPS; _i < DATE_TIME_PROPS_1.length; _i++) {\n      var prop = DATE_TIME_PROPS_1[_i];\n      var p = opt[prop];\n\n      if (p !== undefined) {\n        throw new TypeError(\"Intl.DateTimeFormat can't set option \" + prop + \" when \" + (dateStyle ? 'dateStyle' : 'timeStyle') + \" is used\");\n      }\n    }\n\n    bestFormat = DateTimeStyleFormat(dateStyle, timeStyle, dataLocaleData);\n  }\n\n  for (var prop in opt) {\n    var p = bestFormat[prop];\n\n    if (p !== undefined) {\n      internalSlots[prop] = p;\n    }\n  }\n\n  var pattern;\n\n  if (internalSlots.hour !== undefined) {\n    var hcDefault = dataLocaleData.hourCycle;\n    var hc = internalSlots.hourCycle;\n\n    if (hc == null) {\n      hc = hcDefault;\n    }\n\n    if (hour12 !== undefined) {\n      if (hour12) {\n        if (hcDefault === 'h11' || hcDefault === 'h23') {\n          hc = 'h11';\n        } else {\n          hc = 'h12';\n        }\n      } else {\n        invariant(!hour12, 'hour12 must not be set');\n\n        if (hcDefault === 'h11' || hcDefault === 'h23') {\n          hc = 'h23';\n        } else {\n          hc = 'h24';\n        }\n      }\n    }\n\n    internalSlots.hourCycle = hc;\n\n    if (hc === 'h11' || hc === 'h12') {\n      pattern = bestFormat.pattern12;\n    } else {\n      pattern = bestFormat.pattern;\n    }\n  } else {\n    // @ts-ignore\n    internalSlots.hourCycle = undefined;\n    pattern = bestFormat.pattern;\n  }\n\n  internalSlots.pattern = pattern;\n  return dtf;\n}","map":{"version":3,"sources":["C:/Users/Digivox/dev/Digivox/Refatoracao/squad/node_modules/@formatjs/ecma402-abstract/lib/src/DateTimeFormat/InitializeDateTimeFormat.js"],"names":["CanonicalizeLocaleList","ToDateTimeOptions","GetOption","ResolveLocale","IsValidTimeZoneName","CanonicalizeTimeZoneName","BasicFormatMatcher","BestFitFormatMatcher","invariant","DATE_TIME_PROPS","DateTimeStyleFormat","isTimeRelated","opt","_i","_a","length","prop","value","undefined","TYPE_REGEX","InitializeDateTimeFormat","dtf","locales","opts","getInternalSlots","availableLocales","localeData","getDefaultLocale","getDefaultTimeZone","relevantExtensionKeys","tzData","uppercaseLinks","requestedLocales","options","Object","create","matcher","localeMatcher","calendar","test","RangeError","internalSlots","ca","numberingSystem","nu","hour12","hourCycle","hc","r","locale","dataLocale","timeZone","String","weekday","era","year","month","day","hour","minute","second","timeZoneName","dataLocaleData","formats","keys","join","dateStyle","timeStyle","bestFormat","DATE_TIME_PROPS_1","p","TypeError","pattern","hcDefault","pattern12"],"mappings":"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","sourcesContent":["import { CanonicalizeLocaleList } from '../CanonicalizeLocaleList';\nimport { ToDateTimeOptions } from './ToDateTimeOptions';\nimport { GetOption } from '../GetOption';\nimport { ResolveLocale } from '../ResolveLocale';\nimport { IsValidTimeZoneName } from '../IsValidTimeZoneName';\nimport { CanonicalizeTimeZoneName } from '../CanonicalizeTimeZoneName';\nimport { BasicFormatMatcher } from './BasicFormatMatcher';\nimport { BestFitFormatMatcher } from './BestFitFormatMatcher';\nimport { invariant } from '../utils';\nimport { DATE_TIME_PROPS } from './utils';\nimport { DateTimeStyleFormat } from './DateTimeStyleFormat';\nfunction isTimeRelated(opt) {\n    for (var _i = 0, _a = ['hour', 'minute', 'second']; _i < _a.length; _i++) {\n        var prop = _a[_i];\n        var value = opt[prop];\n        if (value !== undefined) {\n            return true;\n        }\n    }\n    return false;\n}\nvar TYPE_REGEX = /^[a-z0-9]{3,8}$/i;\n/**\n * https://tc39.es/ecma402/#sec-initializedatetimeformat\n * @param dtf DateTimeFormat\n * @param locales locales\n * @param opts options\n */\nexport function InitializeDateTimeFormat(dtf, locales, opts, _a) {\n    var getInternalSlots = _a.getInternalSlots, availableLocales = _a.availableLocales, localeData = _a.localeData, getDefaultLocale = _a.getDefaultLocale, getDefaultTimeZone = _a.getDefaultTimeZone, relevantExtensionKeys = _a.relevantExtensionKeys, tzData = _a.tzData, uppercaseLinks = _a.uppercaseLinks;\n    // @ts-ignore\n    var requestedLocales = CanonicalizeLocaleList(locales);\n    var options = ToDateTimeOptions(opts, 'any', 'date');\n    var opt = Object.create(null);\n    var matcher = GetOption(options, 'localeMatcher', 'string', ['lookup', 'best fit'], 'best fit');\n    opt.localeMatcher = matcher;\n    var calendar = GetOption(options, 'calendar', 'string', undefined, undefined);\n    if (calendar !== undefined && !TYPE_REGEX.test(calendar)) {\n        throw new RangeError('Malformed calendar');\n    }\n    var internalSlots = getInternalSlots(dtf);\n    opt.ca = calendar;\n    var numberingSystem = GetOption(options, 'numberingSystem', 'string', undefined, undefined);\n    if (numberingSystem !== undefined && !TYPE_REGEX.test(numberingSystem)) {\n        throw new RangeError('Malformed numbering system');\n    }\n    opt.nu = numberingSystem;\n    var hour12 = GetOption(options, 'hour12', 'boolean', undefined, undefined);\n    var hourCycle = GetOption(options, 'hourCycle', 'string', ['h11', 'h12', 'h23', 'h24'], undefined);\n    if (hour12 !== undefined) {\n        // @ts-ignore\n        hourCycle = null;\n    }\n    opt.hc = hourCycle;\n    var r = ResolveLocale(availableLocales, requestedLocales, opt, relevantExtensionKeys, localeData, getDefaultLocale);\n    internalSlots.locale = r.locale;\n    calendar = r.ca;\n    internalSlots.calendar = calendar;\n    internalSlots.hourCycle = r.hc;\n    internalSlots.numberingSystem = r.nu;\n    var dataLocale = r.dataLocale;\n    internalSlots.dataLocale = dataLocale;\n    var timeZone = options.timeZone;\n    if (timeZone !== undefined) {\n        timeZone = String(timeZone);\n        if (!IsValidTimeZoneName(timeZone, { tzData: tzData, uppercaseLinks: uppercaseLinks })) {\n            throw new RangeError('Invalid timeZoneName');\n        }\n        timeZone = CanonicalizeTimeZoneName(timeZone, { tzData: tzData, uppercaseLinks: uppercaseLinks });\n    }\n    else {\n        timeZone = getDefaultTimeZone();\n    }\n    internalSlots.timeZone = timeZone;\n    opt = Object.create(null);\n    opt.weekday = GetOption(options, 'weekday', 'string', ['narrow', 'short', 'long'], undefined);\n    opt.era = GetOption(options, 'era', 'string', ['narrow', 'short', 'long'], undefined);\n    opt.year = GetOption(options, 'year', 'string', ['2-digit', 'numeric'], undefined);\n    opt.month = GetOption(options, 'month', 'string', ['2-digit', 'numeric', 'narrow', 'short', 'long'], undefined);\n    opt.day = GetOption(options, 'day', 'string', ['2-digit', 'numeric'], undefined);\n    opt.hour = GetOption(options, 'hour', 'string', ['2-digit', 'numeric'], undefined);\n    opt.minute = GetOption(options, 'minute', 'string', ['2-digit', 'numeric'], undefined);\n    opt.second = GetOption(options, 'second', 'string', ['2-digit', 'numeric'], undefined);\n    opt.timeZoneName = GetOption(options, 'timeZoneName', 'string', ['short', 'long'], undefined);\n    var dataLocaleData = localeData[dataLocale];\n    invariant(!!dataLocaleData, \"Missing locale data for \" + dataLocale);\n    var formats = dataLocaleData.formats[calendar];\n    // UNSPECCED: IMPLEMENTATION DETAILS\n    if (!formats) {\n        throw new RangeError(\"Calendar \\\"\" + calendar + \"\\\" is not supported. Try setting \\\"calendar\\\" to 1 of the following: \" + Object.keys(dataLocaleData.formats).join(', '));\n    }\n    matcher = GetOption(options, 'formatMatcher', 'string', ['basic', 'best fit'], 'best fit');\n    var dateStyle = GetOption(options, 'dateStyle', 'string', ['full', 'long', 'medium', 'short'], undefined);\n    internalSlots.dateStyle = dateStyle;\n    var timeStyle = GetOption(options, 'timeStyle', 'string', ['full', 'long', 'medium', 'short'], undefined);\n    internalSlots.timeStyle = timeStyle;\n    var bestFormat;\n    if (dateStyle === undefined && timeStyle === undefined) {\n        if (matcher === 'basic') {\n            bestFormat = BasicFormatMatcher(opt, formats);\n        }\n        else {\n            if (isTimeRelated(opt)) {\n                opt.hour12 =\n                    internalSlots.hourCycle === 'h11' ||\n                        internalSlots.hourCycle === 'h12';\n            }\n            bestFormat = BestFitFormatMatcher(opt, formats);\n        }\n    }\n    else {\n        for (var _i = 0, DATE_TIME_PROPS_1 = DATE_TIME_PROPS; _i < DATE_TIME_PROPS_1.length; _i++) {\n            var prop = DATE_TIME_PROPS_1[_i];\n            var p = opt[prop];\n            if (p !== undefined) {\n                throw new TypeError(\"Intl.DateTimeFormat can't set option \" + prop + \" when \" + (dateStyle ? 'dateStyle' : 'timeStyle') + \" is used\");\n            }\n        }\n        bestFormat = DateTimeStyleFormat(dateStyle, timeStyle, dataLocaleData);\n    }\n    for (var prop in opt) {\n        var p = bestFormat[prop];\n        if (p !== undefined) {\n            internalSlots[prop] = p;\n        }\n    }\n    var pattern;\n    if (internalSlots.hour !== undefined) {\n        var hcDefault = dataLocaleData.hourCycle;\n        var hc = internalSlots.hourCycle;\n        if (hc == null) {\n            hc = hcDefault;\n        }\n        if (hour12 !== undefined) {\n            if (hour12) {\n                if (hcDefault === 'h11' || hcDefault === 'h23') {\n                    hc = 'h11';\n                }\n                else {\n                    hc = 'h12';\n                }\n            }\n            else {\n                invariant(!hour12, 'hour12 must not be set');\n                if (hcDefault === 'h11' || hcDefault === 'h23') {\n                    hc = 'h23';\n                }\n                else {\n                    hc = 'h24';\n                }\n            }\n        }\n        internalSlots.hourCycle = hc;\n        if (hc === 'h11' || hc === 'h12') {\n            pattern = bestFormat.pattern12;\n        }\n        else {\n            pattern = bestFormat.pattern;\n        }\n    }\n    else {\n        // @ts-ignore\n        internalSlots.hourCycle = undefined;\n        pattern = bestFormat.pattern;\n    }\n    internalSlots.pattern = pattern;\n    return dtf;\n}\n"]},"metadata":{},"sourceType":"module"}