{"ast":null,"code":"'use strict';\n\nvar TimeoutError = require('./TimeoutError'); // eslint-disable-next-line default-param-last\n\n\nmodule.exports = function promise(EE, event) {\n  var rejectEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'error';\n  var timeout = arguments.length > 3 ? arguments[3] : undefined;\n  return new Promise(function (resolve, reject) {\n    var timeoutId;\n\n    var cleanup = function cleanup() {\n      clearTimeout(timeoutId);\n      EE.removeListener(event, onEvent);\n      EE.removeListener(rejectEvent, onError);\n    };\n\n    function onError(reason) {\n      reject(reason);\n      cleanup();\n    }\n\n    function onEvent(value) {\n      resolve(value);\n      cleanup();\n    }\n\n    EE.once(event, onEvent);\n\n    if (rejectEvent) {\n      EE.once(rejectEvent, onError);\n    }\n\n    if (timeout) {\n      timeoutId = setTimeout(function () {\n        cleanup();\n        reject(new TimeoutError());\n      }, timeout);\n    }\n  });\n};","map":{"version":3,"sources":["C:/Users/Digivox/dev/Digivox/Refatoracao/squad/node_modules/@xmpp/events/lib/promise.js"],"names":["TimeoutError","require","module","exports","promise","EE","event","rejectEvent","timeout","Promise","resolve","reject","timeoutId","cleanup","clearTimeout","removeListener","onEvent","onError","reason","value","once","setTimeout"],"mappings":"AAAA;;AAEA,IAAMA,YAAY,GAAGC,OAAO,CAAC,gBAAD,CAA5B,C,CAEA;;;AACAC,MAAM,CAACC,OAAP,GAAiB,SAASC,OAAT,CAAiBC,EAAjB,EAAqBC,KAArB,EAA4D;AAAA,MAAhCC,WAAgC,uEAAlB,OAAkB;AAAA,MAATC,OAAS;AAC3E,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAIC,SAAJ;;AAEA,QAAMC,OAAO,GAAG,SAAVA,OAAU,GAAM;AACpBC,MAAAA,YAAY,CAACF,SAAD,CAAZ;AACAP,MAAAA,EAAE,CAACU,cAAH,CAAkBT,KAAlB,EAAyBU,OAAzB;AACAX,MAAAA,EAAE,CAACU,cAAH,CAAkBR,WAAlB,EAA+BU,OAA/B;AACD,KAJD;;AAMA,aAASA,OAAT,CAAiBC,MAAjB,EAAyB;AACvBP,MAAAA,MAAM,CAACO,MAAD,CAAN;AACAL,MAAAA,OAAO;AACR;;AAED,aAASG,OAAT,CAAiBG,KAAjB,EAAwB;AACtBT,MAAAA,OAAO,CAACS,KAAD,CAAP;AACAN,MAAAA,OAAO;AACR;;AAEDR,IAAAA,EAAE,CAACe,IAAH,CAAQd,KAAR,EAAeU,OAAf;;AACA,QAAIT,WAAJ,EAAiB;AACfF,MAAAA,EAAE,CAACe,IAAH,CAAQb,WAAR,EAAqBU,OAArB;AACD;;AAED,QAAIT,OAAJ,EAAa;AACXI,MAAAA,SAAS,GAAGS,UAAU,CAAC,YAAM;AAC3BR,QAAAA,OAAO;AACPF,QAAAA,MAAM,CAAC,IAAIX,YAAJ,EAAD,CAAN;AACD,OAHqB,EAGnBQ,OAHmB,CAAtB;AAID;AACF,GA9BM,CAAP;AA+BD,CAhCD","sourcesContent":["'use strict'\n\nconst TimeoutError = require('./TimeoutError')\n\n// eslint-disable-next-line default-param-last\nmodule.exports = function promise(EE, event, rejectEvent = 'error', timeout) {\n  return new Promise((resolve, reject) => {\n    let timeoutId\n\n    const cleanup = () => {\n      clearTimeout(timeoutId)\n      EE.removeListener(event, onEvent)\n      EE.removeListener(rejectEvent, onError)\n    }\n\n    function onError(reason) {\n      reject(reason)\n      cleanup()\n    }\n\n    function onEvent(value) {\n      resolve(value)\n      cleanup()\n    }\n\n    EE.once(event, onEvent)\n    if (rejectEvent) {\n      EE.once(rejectEvent, onError)\n    }\n\n    if (timeout) {\n      timeoutId = setTimeout(() => {\n        cleanup()\n        reject(new TimeoutError())\n      }, timeout)\n    }\n  })\n}\n"]},"metadata":{},"sourceType":"script"}